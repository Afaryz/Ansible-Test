---
- name: all then filter
  hosts: all

  become: true
  vars:
    node_prefix: "rbpcm-node-"

  tasks:
    - name: Nur Hosts mit gewünschter Node-Nummer
      debug:
      #  msg: "Ich bin {{ inventory_hostname }}"
      #when: inventory_hostname == (node_prefix ~ target_node | string)
       msg: "Ich bin {{ node}}"
      when: node == (target_node | string)

    - name: Nur Hosts mit gewünschter Node-Nummer
      debug:
        msg: "Ich bin {{ inventory_hostname }}"
      when: inventory_hostname == (node_prefix ~ target_node | string)
      
    - name: Nur Hosts aus gewünschtem Land
      debug:
        msg: "Land {{ country }} ausgewählt"
      when: country == target_country | default(country)

    - name: Nur Hosts mit gewünschter Node-Nummer STRINGParsing
      debug:
        msg: "Ich bin {{ inventory_hostname }} mit node={{ node }}"
      when: (node | string) == (target_node | default(node) | string)

    - name: Nur Hosts aus gewünschtem Land
      debug:
        msg: "Land {{ country }} ausgewählt"
      when: (country | string) == (target_country | default(country) | string)

- name: try filter first auf gerade
  hosts: gerade
  tasks:
    - name: Welcher Host mit welchem Node
      debug:
        msg: "Ich bin {{ inventory_hostname }} mit node={{ node }}"
    - name: Welches Land
      debug:
        msg: "Land {{ country }} ausgewählt"
    - name: Debug Enum
      debug: 
        msg: "{{ range_nodes}}"
- name: try filter auf BUCHUNGSNR 300 - node 3 & 4
  hosts: 300
  tasks:
    - name: update apt packages
      apt:
        upgrade: yes
        update_cache: yes
    
#    - name: update apt packages
#      apt:
#        upgrade: yes
#        update_cache: yes
        